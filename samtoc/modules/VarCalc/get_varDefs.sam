## Copyright 2013-2014 the Samizdat Authors (Dan Bornstein et alia).
## Licensed AS IS and WITHOUT WARRANTY under the Apache License,
## Version 2.0. Details: <http://www.apache.org/licenses/LICENSE-2.0>

import core.Lang0Node ::
    get_name,
    get_nodeValue,
    makeDynamicImport;


##
## Exported Generics
##

## `node.get_varDefs()`: Generic that returns list of variable names
## newly-defined by `node`. Result may have duplicates.
export fn .get_varDefs();


##
## Private Definitions
##

## Extracts and combines the `varDefs` of all the arguments.
fn catVarDefs(nodes*) {
    return [].cat(( n in nodes -> n.varDefs )*)
};


##
## Exported Definitions
##

fn @@apply.get_varDefs() {
    return []
};

fn @@call.get_varDefs() {
    return []
};

fn @@closure.get_varDefs() {
    return []
};

fn @@export.get_varDefs() {
    return this.nodeValue.varDefs
};

fn @@exportSelection.get_varDefs() {
    return []
};

fn @@importModule.get_varDefs() {
    return [this.name]
};

fn @@importModuleSelection.get_varDefs() {
    def statements = makeDynamicImport(this);
    return catVarDefs(statements*)
};

fn @@importResource.get_varDefs() {
    return [this.name]
};

fn @@literal.get_varDefs() {
    return []
};

fn @@literalRef.get_varDefs() {
    return []
};

fn @@maybe.get_varDefs() {
    return []
};

fn @@noYield.get_varDefs() {
    return []
};

fn @@varBind.get_varDefs() {
    return []
};

fn @@varDef.get_varDefs() {
    return [this.name]
};

fn @@varDefMutable.get_varDefs() {
    return [this.name]
};

fn @@varRef.get_varDefs() {
    return []
};

fn @@void.get_varDefs() {
    return []
};

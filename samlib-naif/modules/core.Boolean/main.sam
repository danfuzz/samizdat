## Copyright 2013-2014 the Samizdat Authors (Dan Bornstein et alia).
## Licensed AS IS and WITHOUT WARRANTY under the Apache License,
## Version 2.0. Details: <http://www.apache.org/licenses/LICENSE-2.0>

##
## Booleans
##

#= language core.Lang0

import core.Bitwise ::
    and,
    bit,
    bitSize,
    not,
    or,
    shl,
    xor;


##
## Exported Definitions
##

## Documented in spec.
fn @@Boolean.and(other) {
    <> @Boolean(and(dataOf(this), dataOf(other)))
};

## Documented in spec.
fn @@Boolean.bit(n) {
    <> bit(dataOf(this), n)
};

## Documented in spec.
fn @@Boolean.bitSize() {
    <> 1
};

## Documented in spec.
fn @@Boolean.not() {
    <> @Boolean(xor(dataOf(this), 1))
};

## Documented in spec.
fn @@Boolean.or(other) {
    <> @Boolean(or(dataOf(this), dataOf(other)))
};

## Documented in spec.
fn @@Boolean.shl(n) {
    def newValue = shl(dataOf(this), n);

    <> ifValueOr { <> get({0: false, 1: true}, newValue) }
        { die("Undefined boolean shift result.") }
};

## Documented in spec.
fn @@Boolean.toInt() {
    <> dataOf(this)
};

## Documented in spec.
fn @@Boolean.toNumber() {
    <> dataOf(this)
};

## Documented in spec.
fn @@Boolean.xor(other) {
    <> @Boolean(xor(dataOf(this), dataOf(other)))
};

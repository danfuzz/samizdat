## Copyright 2013-2014 the Samizdat Authors (Dan Bornstein et alia).
## Licensed AS IS and WITHOUT WARRANTY under the Apache License,
## Version 2.0. Details: <http://www.apache.org/licenses/LICENSE-2.0>

##
## PEG (Parsing Expression Grammar) support
##

#= language core.Lang0

import ./BasicState :: *;


##
## Exported Definitions
##

## Documented in spec.
export fn apply(rule, input) {
    def in = BasicState.new(input);
    def result;

    return? ifIs { in.applyRule(rule, result?, []) }
        { result }
};

## Documented in spec.
export fn stringFromTokenList(tokens) {
    return "".cat((tokens.collect { t -> t.get_name() })*)
};

## Documented in spec.
export fn symbolFromTokenList(tokens) {
    return @"".cat((tokens.collect { t -> t.get_name() })*)
};

# Copyright 2013 the Samizdat Authors (Dan Bornstein et alia).
# Licensed AS IS and WITHOUT WARRANTY under the Apache License,
# Version 2.0. Details: <http://www.apache.org/licenses/LICENSE-2.0>

#
# Box functions
#


#
# Exported Definitions
#

# Documented in Samizdat Layer 0 spec.
fn update(box, updateFunction) {
    <> ifValue { <> fetch(box) }
        { value <> store(box, updateFunction(value)) }
        { <> store(box, updateFunction()) }
};

# Other than `update`, this is a re-export of functions from the
# primitive core library.

<> {
    canStore:       Box_canStore,
    fetch:          Box_fetch,
    makeMutableBox: Box_makeMutableBox,
    makeYieldBox:   Box_makeYieldBox,
    nullBox:        nullBox,
    store:          Box_store,
    update:         update
}
